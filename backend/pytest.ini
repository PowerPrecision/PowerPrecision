[pytest]
asyncio_mode = auto
testpaths = tests
python_files = test_*.py
python_classes = Test*
python_functions = test_*

# CRÍTICO: Mantém o loop de eventos aberto durante toda a sessão de testes
# Isto previne o erro "RuntimeError: Event loop is closed"
asyncio_default_fixture_loop_scope = session

# CONFIGURAÇÃO:
# Ignorar pasta E2E e ficheiros antigos/problemáticos
addopts = -v -p no:warnings --ignore=tests/e2e --ignore-glob=tests/test_iteration*.py --ignore=tests/test_websocket.py

# Variáveis de ambiente para teste
env =
    TEST_API_URL=http://testserver/api
    REACT_APP_BACKEND_URL=http://testserver
    MONGODB_URL=mongodb://localhost:27017
    DB_NAME=test_db_precision
    JWT_SECRET=test_secret_key_123
    TESTING=true